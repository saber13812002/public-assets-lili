class PlacePicker{constructor(e={}){let t=this;e={defaultLocation:{lat:-34.397,lng:150.644},defaultZoom:12,title:"Title",searchLabel:"Search",btnDoneText:"Done",changeLocationCallback:function(){},doneBtnCallback:function(){},closeBtnCallback:function(){},beforeGenerate:function(){},afterGenerate:function(){},beforeDistory:function(){},afterDistory:function(){},...e},this.config=e,this.frame=$('<div class="place-picker"></div>'),this.overlay=$('<div class="overlay"></div>'),this.content=$('<div class="content"></div>'),this.innerContent=$('<div class="inner-content"></div>'),this.header=$('<div class="header"></div>'),this.footer=$('<div class="footer"></div>'),this.mapWrapper=$('<div class="map-wrapper"></div>'),this.map=$('<div class="map"></div>'),this.search=$('<input type="search">'),this.closeBtn=$('<button type="button" class="btn btn-icon"><i class="icon-close"></i></button>'),this.currentLocationBtn=$('<button type="button" class="btn-current-location"><i class="icon-gps"></i></button>'),this.doneBtn=$(`<button type="button" class="btn btn-primary">${e.btnDoneText}</button>`),this.appbar=$('<div class="app-bar"></div>'),this.appbarContainer=$('<div class="app-bar-container"></div>'),this.appbarLeading=$('<div class="leading"></div>'),this.appbarTitle=$('<div class="app-bar-title"></div>'),this.appbarActions=$('<div class="actions"></div>'),this.appbarTitleText=$(`<span>${e.title}</span>`),this.appbarLeadingBtn=$('<button type="button" class="btn btn-icon"><i class="icon-location"></i></button>'),this.appbarActionBtn=$('<button type="button" class="btn btn-icon"><i class="icon-tick"></i></button>'),this.address="",this.position=e.defaultLocation,this.mapObject,this.mapMarker,this.appbarTitle.append(this.appbarTitleText),this.appbarLeading.append(this.appbarLeadingBtn),this.appbarActions.append([this.appbarActionBtn,this.appbarActionLink]),this.appbarContainer.append([this.appbarLeading,this.appbarTitle,this.appbarActions]),this.appbar.append(this.appbarContainer),this.frame.append([this.overlay,this.content]),this.header.append([this.getSearchField(),this.closeBtn]),this.mapWrapper.append([this.map,this.currentLocationBtn]),this.footer.append(this.doneBtn),this.content.append([this.appbar,this.innerContent]),this.innerContent.append([this.header,this.mapWrapper,this.footer]),this.mapGenerate(),this.searchAutocomplete(),this.currentLocationBtn.on("click",(function(){t.goToCurrentPosition()})),this.doneBtn.on("click",(function(){e.doneBtnCallback(t)})),this.appbarActionBtn.on("click",(function(){e.doneBtnCallback(t)})),this.closeBtn.on("click",(function(){e.closeBtnCallback(t)})),this.overlay.on("click",(function(){e.closeBtnCallback(t)})),this.generate()}generate(){let e=this;this.config.beforeGenerate(this),$("body").append(this.frame),setTimeout((function(){e.frame.addClass("visible")}),1),this.config.afterGenerate(this)}distory(){let e=this;this.config.beforeDistory(this),this.frame.removeClass("visible"),setTimeout((function(){e.frame.remove()}),160),this.config.afterDistory(this)}searchAutocomplete(){let e=new google.maps.places.Autocomplete(this.search[0],{types:["geocode"]});google.maps.event.addListener(e,"place_changed",(function(){e.getPlace()}))}mapGenerate(){let e=this;this.mapObject=new google.maps.Map(this.map[0],{center:e.config.defaultLocation,zoom:e.config.defaultZoom,mapTypeControl:!1,disableDefaultUI:!0,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:this.getMapStyle()}),this.mapMarker=new google.maps.Marker({map:this.mapObject,draggable:!0,animation:google.maps.Animation.DROP,position:e.config.defaultLocation}),this.geoCodePosition(this.mapMarker.getPosition()),this.mapObject.addListener("click",(t=>{e.updateMarkPosition(t.latLng.lat(),t.latLng.lng())})),google.maps.event.addListener(this.mapMarker,"dragend",(function(){e.mapObject.setCenter(e.mapMarker.getPosition()),e.geoCodePosition(e.mapMarker.getPosition())}))}geoCodePosition(e){let t=this;(new google.maps.Geocoder).geocode({latLng:e},(function(a,i){i==google.maps.GeocoderStatus.OK?t.address=a[0].formatted_address:t.position={lat:e.lat(),lng:e.lng()}}))}goToCurrentPosition(){let e=this;navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(t){e.mapObject.setOptions({zoom:15}),e.updateMarkPosition(t.coords.latitude,t.coords.longitude)}))}updateMarkPosition(e,t){this.mapMarker.setPosition({lat:e,lng:t}),this.mapObject.setCenter({lat:e,lng:t}),this.geoCodePosition(this.mapMarker.getPosition()),this.config.changeLocationCallback(this)}getCurrentAddress(){return""!=this.address?this.address:this.position.lat+", "+this.position.lng}getMapStyle(){return[{elementType:"geometry",stylers:[{color:"#ebe3cd"}]},{elementType:"labels.text.fill",stylers:[{color:"#523735"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f5f1e6"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#c9b2a6"}]},{featureType:"administrative.land_parcel",elementType:"geometry.stroke",stylers:[{color:"#dcd2be"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#ae9e90"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#93817c"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#a5b076"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#447530"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#f5f1e6"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#fdfcf8"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#f8c967"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#e9bc62"}]},{featureType:"road.highway.controlled_access",elementType:"geometry",stylers:[{color:"#e98d58"}]},{featureType:"road.highway.controlled_access",elementType:"geometry.stroke",stylers:[{color:"#db8555"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#806b63"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"transit.line",elementType:"labels.text.fill",stylers:[{color:"#8f7d77"}]},{featureType:"transit.line",elementType:"labels.text.stroke",stylers:[{color:"#ebe3cd"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#b9d3c2"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#92998d"}]}]}getSearchField(){let e=$('<div class="field field-type-nr-input"></div>'),t=$('<div class="field-content"></div>'),a=$('<i class="icon-search-normal"></i>'),i=$(`<label>${this.config.searchLabel}</label>`);return e.append([a,t]),t.append([i,this.search]),this.search.on("focus",(function(){e.addClass("field--focus field--lv-label")})),this.search.on("blur",(function(){e.removeClass("field--focus"),""==$(this).val()&&e.removeClass("field--lv-label")})),this.search.on("change",(function(){""==$(this).val()?e.removeClass("field--lv-label"):e.addClass("field--lv-label")})),e}}