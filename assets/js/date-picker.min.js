class DatePicker{constructor(t={}){let e=this;t={element:null,date:null,minDate:null,type:"date",mode:"normal",title:"Date",parent:null,isRange:!1,submitBtnText:"Submit",closeBtnIcon:"icon-close",selectCallback:function(){},closeBtnCallback:function(){},submitBtnCallback:function(){},beforeGenerate:function(){},afterGenerate:function(){},beforeDistory:function(){},afterDistory:function(){},...t},this.config=t,this.frame=$(`<div class="date-picker type-${t.type} mode-${t.mode}"></div>`),this.overlay=$('<div class="overlay"></div>'),this.content=$('<div class="content"></div>'),this.innerContent=$('<div class="inner-content"></div>'),this.header=$('<div class="header"></div>'),this.title=$(`<div class="title">${t.title}</div>`),this.closeBtn=$(`<button type="button" class="btn btn-icon"><i class="${t.closeBtnIcon}"></i></button>`),this.footer=$('<div class="footer"></div>'),this.submitBtn=$(`<button type="button" class="btn btn-primary btn-full">${t.submitBtnText}</button>`),this.input=$('<input type="hidden">'),this.frame.append([this.overlay,this.content]),this.content.append([this.header,this.innerContent,this.footer]),this.header.append([this.title,this.closeBtn]),this.footer.append([this.submitBtn]),this.innerContent.append([this.input]),t.date&&this.input.val(t.date),"date"==t.type?"normal"==t.mode?this.getDatePicker():this.getWheelDatePicker():this.getWheelTimePicker(),this.closeBtn.on("click",(function(){t.closeBtnCallback(e)})),this.overlay.on("click",(function(){t.closeBtnCallback(e),e.distory()})),this.submitBtn.on("click",(function(){t.submitBtnCallback(e)})),this.generate()}generate(){let t=this;if(this.config.beforeGenerate(this),this.config.parent){if(this.config.parent.append(this.frame),setTimeout((function(){t.frame.addClass("visible"),bodyOverflowController(!0)}),1),$(window).width()>576){function e(){const e=t.config.parent[0].getBoundingClientRect(),n=t.content.height(),i=$(window).height(),s=n+e.y,a=e.y-(s-i);t.content.css({top:s>i?a<0?0:a:e.y,left:e.x,width:e.width})}e(),$(window).on("scroll",e),this.config.parent.parents("*").on("scroll",e),t.content.on("destroy",(function(){$(window).off("scroll",e),t.config.parent.parents("*").off("scroll",e)}))}}else console.log("Please Set Parent Element");this.config.afterGenerate(this)}distory(){let t=this;this.config.beforeDistory(this),this.frame.removeClass("visible"),this.content.trigger("destroy"),setTimeout((function(){t.frame.remove(),bodyOverflowController()}),160),this.config.afterDistory(this)}getDatePicker(){let t=this;new Lightpick({field:this.input[0],inline:!0,repick:!!this.config.date,format:"YYYY/MM/DD",minDate:this.config.minDate,singleDate:!this.config.isRange,onSelect:function(e,n){t.config.selectCallback(t,e,n)}})}getWheelDatePicker(){let t=this,e=moment(),n=moment(this.config.date?this.input.val():new Date,"YYYY/MM/DD"),i=Number.parseInt(e.format("YYYY")),s=Number.parseInt(n.format("YYYY")),a=Number.parseInt(n.format("M")),o=Number.parseInt(n.format("D")),l=n.daysInMonth(),r=$('<div class="wheel-years"><div class="wheel-label">Year</div></div>'),c=$('<div class="wheel-months"><div class="wheel-label">Month</div></div>'),h=$('<div class="wheel-days"><div class="wheel-label">Day</div></div>'),u=new WheelPicker({around:1,items:this.getYears(1900,i),default:s,onSelect:function(e){s=Number.parseInt(e),t.setDateInput(s,a,o)}}),d=new WheelPicker({around:1,items:this.getMonths(n),default:a,onSelect:function(e){a=Number.parseInt(e),t.setDateInput(s,a,o)}}),m=new WheelPicker({around:1,items:this.getDays(l),default:o,onSelect:function(e){o=Number.parseInt(e),t.setDateInput(s,a,o)}});r.append(u),c.append(d),h.append(m),this.innerContent.append([r,c,h])}getWheelTimePicker(){let t=this,e=moment(this.config.date?this.input.val():new Date,"HH:mm"),n=Number.parseInt(e.format("H")),i=Number.parseInt(e.format("mm")),s=this.config.minDate?moment(this.config.minDate,"HH:mm"):null,a=s?Number.parseInt(s.format("H")):1,o=s?Number.parseInt(s.format("mm")):0,l=$('<div class="wheel-hour"><div class="wheel-label">Hour</div></div>'),r=$('<div class="wheel-minute"><div class="wheel-label">Minute</div></div>'),c=new WheelPicker({around:1,items:this.getMinute(n===a?o:0),default:i,onSelect:function(e){i=Number.parseInt(e),t.setTimeInput(n,i)}}),h=new WheelPicker({around:1,items:this.getHour(a,24),default:n>=a?n:a,onSelect:function(e){let s=n;n=Number.parseInt(e),t.setTimeInput(n,i),t.config.minDate&&(n===a?c.attr("data-items",JSON.stringify(t.getMinute(o))):c.attr("data-items",JSON.stringify(t.getMinute(0))),s!==n&&c.trigger("reset"))}});l.append(h),r.append(c),this.innerContent.append([l,'<div class="seperator">:</div>',r])}setDateInput(t,e,n){this.input.val(`${this.formatNumber(t)}/${this.formatNumber(e)}/${this.formatNumber(n)}`)}setTimeInput(t,e){this.input.val(`${this.formatNumber(t)}:${this.formatNumber(e)} ${t>=12?"PM":"AM"}`)}formatNumber(t){return t<10?`0${t}`:t}getHour(t,e){let n=[];for(let i=t;i<=e;i++)n.push({value:i,label:i});return n}getMinute(t){let e=[];for(let n=t;n<=59;n++)e.push({value:n,label:n});return e}getYears(t,e){let n=[];for(let i=t;i<=e;i++)n.push({value:i,label:i});return n}getMonths(t){let e=[];for(let n=0;n<12;n++){let i=t.set("month",n);e.push({value:n+1,label:i.format("MMM")})}return e}getDays(t){let e=[];for(let n=1;n<=t;n++)e.push({value:n,label:n});return e}}